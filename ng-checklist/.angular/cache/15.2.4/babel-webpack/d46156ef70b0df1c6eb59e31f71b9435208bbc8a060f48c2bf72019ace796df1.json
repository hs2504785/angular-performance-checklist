{"ast":null,"code":"import { FormControl, Validators } from '@angular/forms';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { of, timer } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\nimport { selectOnce } from '../../shared/operators';\nimport { convertToProjectId } from '../../shared/utils';\nimport { ProjectsSelectors } from '../state/projects.selectors';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ngrx/store\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/material/button\";\nimport * as i5 from \"@angular/material/input\";\nimport * as i6 from \"@angular/material/form-field\";\nimport * as i7 from \"@angular/material/progress-spinner\";\nimport * as i8 from \"@angular/forms\";\nfunction ProjectDialogComponent_mat_error_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"Project already exists\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProjectDialogComponent_mat_spinner_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mat-spinner\", 9);\n  }\n}\nfunction ProjectDialogComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 10)(1, \"h4\");\n    i0.ɵɵtext(2, \"DANGER ZONE\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ul\", 11)(4, \"li\", 12)(5, \"span\", 13);\n    i0.ɵɵtext(6, \"Delete Project\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 14)(8, \"p\");\n    i0.ɵɵtext(9, \"Once you delete a project, there is no going back. Please be certain.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"mat-form-field\");\n    i0.ɵɵelement(11, \"input\", 15);\n    i0.ɵɵelementStart(12, \"mat-hint\", 3);\n    i0.ɵɵtext(13, \"Please type in the project name to confirm.\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(14, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function ProjectDialogComponent_div_11_Template_button_click_14_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.deleteProject());\n    });\n    i0.ɵɵtext(15, \" Delete this Project \");\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(11);\n    i0.ɵɵproperty(\"formControl\", ctx_r2.verifyProjectName);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"disabled\", !ctx_r2.verifyProjectName.valid);\n  }\n}\nexport var ProjectDialogMode = /*#__PURE__*/(() => {\n  (function (ProjectDialogMode) {\n    ProjectDialogMode[\"Create\"] = \"Create\";\n    ProjectDialogMode[\"Edit\"] = \"Edit\";\n  })(ProjectDialogMode || (ProjectDialogMode = {}));\n  return ProjectDialogMode;\n})();\nexport var ProjectDialogResultType = /*#__PURE__*/(() => {\n  (function (ProjectDialogResultType) {\n    ProjectDialogResultType[\"AddOrEdit\"] = \"AddOrEdit\";\n    ProjectDialogResultType[\"Delete\"] = \"Delete\";\n  })(ProjectDialogResultType || (ProjectDialogResultType = {}));\n  return ProjectDialogResultType;\n})();\nclass CustomErrorStateMatcher {\n  isErrorState(control) {\n    return !!(control && control.invalid && (control.dirty || control.touched));\n  }\n}\nconst validateProjectId = (whitelist = [], store) => {\n  return control => {\n    whitelist = typeof whitelist === 'string' ? [whitelist] : whitelist;\n    return whitelist.includes(control.value) ? of(null) : timer(300).pipe(switchMap(_ => store.pipe(selectOnce(ProjectsSelectors.getProjectById(convertToProjectId(control.value))))), map(project => !project ? null : {\n      projectExists: true\n    }));\n  };\n};\nconst verifyProjectName = projectName => {\n  return control => {\n    return control.value === projectName ? null : {\n      verifyProjectName: true\n    };\n  };\n};\nexport let ProjectDialogComponent = /*#__PURE__*/(() => {\n  class ProjectDialogComponent {\n    constructor(data, store, dialogRef) {\n      this.data = data;\n      this.store = store;\n      this.dialogRef = dialogRef;\n      this.enableDangerZone = false;\n      this.showDangerZone = false;\n      this.maxLength = 25;\n      this.projectName = new FormControl('', [Validators.required, Validators.maxLength(this.maxLength)]);\n      this.verifyProjectName = new FormControl('');\n      this.errorStateMatcher = new CustomErrorStateMatcher();\n    }\n    ngOnInit() {\n      const {\n        title,\n        project,\n        mode = ProjectDialogMode.Create,\n        submitButtonText\n      } = this.data;\n      this.project = project ? project : {\n        name: ''\n      };\n      this.mode = mode;\n      this.title = title;\n      this.submitButtonText = !submitButtonText ? title : submitButtonText;\n      this.projectName.setValue(this.project.name);\n      this.projectName.setAsyncValidators(validateProjectId(this.project.name, this.store));\n      this.verifyProjectName.setValidators(verifyProjectName(this.project.name));\n    }\n    close(deleteProject = false) {\n      if (deleteProject) {\n        return this.dialogRef.close({\n          type: ProjectDialogResultType.Delete,\n          payload: {\n            id: this.project.id\n          }\n        });\n      }\n      if (this.canClose()) {\n        const projectName = this.projectName.value;\n        const projectId = this.generateProjectId(projectName);\n        return this.dialogRef.close({\n          type: ProjectDialogResultType.AddOrEdit,\n          payload: {\n            id: projectId,\n            name: projectName\n          }\n        });\n      }\n    }\n    deleteProject() {\n      this.close(true);\n    }\n    isEditMode() {\n      return this.mode === ProjectDialogMode.Edit;\n    }\n    canClose() {\n      return this.projectName.valid && !this.projectName.pending && this.projectName.dirty && !this.projectName.pristine && this.hasChanged(this.projectName.value, this.project.name);\n    }\n    generateProjectId(name) {\n      return convertToProjectId(name.trim());\n    }\n    hasChanged(current, old) {\n      const currentId = this.generateProjectId(current);\n      const oldId = this.generateProjectId(old);\n      return currentId !== oldId;\n    }\n  }\n  ProjectDialogComponent.ɵfac = function ProjectDialogComponent_Factory(t) {\n    return new (t || ProjectDialogComponent)(i0.ɵɵdirectiveInject(MAT_DIALOG_DATA), i0.ɵɵdirectiveInject(i1.Store), i0.ɵɵdirectiveInject(i2.MatDialogRef));\n  };\n  ProjectDialogComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ProjectDialogComponent,\n    selectors: [[\"ac-project-dialog\"]],\n    decls: 17,\n    vars: 12,\n    consts: [[\"mat-dialog-title\", \"\"], [1, \"project-info\"], [\"matInput\", \"\", \"cdkFocusInitial\", \"\", \"placeholder\", \"Project Name\", \"type\", \"text\", 3, \"formControl\", \"errorStateMatcher\", \"keydown.enter\"], [\"align\", \"end\"], [4, \"ngIf\"], [\"diameter\", \"20\", \"color\", \"primary\", \"matSuffix\", \"\", 4, \"ngIf\"], [\"class\", \"danger-zone-wrapper\", 4, \"ngIf\"], [\"mat-button\", \"\", 3, \"mat-dialog-close\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"disabled\", \"mat-dialog-close\", \"click\"], [\"diameter\", \"20\", \"color\", \"primary\", \"matSuffix\", \"\"], [1, \"danger-zone-wrapper\"], [1, \"danger-zone\"], [1, \"danger-zone-cta\"], [1, \"danger-zone-cta-title\"], [1, \"danger-zone-cta-content\"], [\"matInput\", \"\", \"type\", \"text\", 3, \"formControl\"], [\"mat-raised-button\", \"\", \"color\", \"warn\", 3, \"disabled\", \"click\"]],\n    template: function ProjectDialogComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"h1\", 0)(1, \"span\");\n        i0.ɵɵtext(2);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(3, \"mat-dialog-content\")(4, \"div\", 1)(5, \"mat-form-field\")(6, \"input\", 2);\n        i0.ɵɵlistener(\"keydown.enter\", function ProjectDialogComponent_Template_input_keydown_enter_6_listener() {\n          return ctx.close();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"mat-hint\", 3);\n        i0.ɵɵtext(8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(9, ProjectDialogComponent_mat_error_9_Template, 2, 0, \"mat-error\", 4);\n        i0.ɵɵtemplate(10, ProjectDialogComponent_mat_spinner_10_Template, 1, 0, \"mat-spinner\", 5);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(11, ProjectDialogComponent_div_11_Template, 16, 2, \"div\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"mat-dialog-actions\", 3)(13, \"button\", 7);\n        i0.ɵɵtext(14, \"Cancel\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"button\", 8);\n        i0.ɵɵlistener(\"click\", function ProjectDialogComponent_Template_button_click_15_listener() {\n          return ctx.close();\n        });\n        i0.ɵɵtext(16);\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.title);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"formControl\", ctx.projectName)(\"errorStateMatcher\", ctx.errorStateMatcher);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate2(\"\", (ctx.projectName.value == null ? null : ctx.projectName.value.length) || 0, \"/\", ctx.maxLength, \"\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.projectName.hasError(\"projectExists\"));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.projectName.pending);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isEditMode());\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"mat-dialog-close\", null);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"disabled\", !ctx.canClose())(\"mat-dialog-close\", ctx.projectName.value);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate1(\" \", ctx.submitButtonText, \" \");\n      }\n    },\n    dependencies: [i3.NgIf, i4.MatButton, i2.MatDialogClose, i2.MatDialogTitle, i2.MatDialogContent, i2.MatDialogActions, i5.MatInput, i6.MatFormField, i6.MatHint, i6.MatError, i6.MatSuffix, i7.MatProgressSpinner, i8.DefaultValueAccessor, i8.NgControlStatus, i8.FormControlDirective],\n    styles: [\".mat-ripple[_ngcontent-%COMP%]{overflow:hidden;position:relative}.mat-ripple[_ngcontent-%COMP%]:not(:empty){transform:translateZ(0)}.mat-ripple.mat-ripple-unbounded[_ngcontent-%COMP%]{overflow:visible}.mat-ripple-element[_ngcontent-%COMP%]{position:absolute;border-radius:50%;pointer-events:none;transition:opacity,transform 0ms cubic-bezier(0,0,.2,1);transform:scale3d(0,0,0)}.cdk-high-contrast-active[_ngcontent-%COMP%]   .mat-ripple-element[_ngcontent-%COMP%]{display:none}.cdk-visually-hidden[_ngcontent-%COMP%]{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap;outline:0;-webkit-appearance:none;-moz-appearance:none;left:0}[dir=rtl][_ngcontent-%COMP%]   .cdk-visually-hidden[_ngcontent-%COMP%]{left:auto;right:0}.cdk-overlay-container[_ngcontent-%COMP%], .cdk-global-overlay-wrapper[_ngcontent-%COMP%]{pointer-events:none;top:0;left:0;height:100%;width:100%}.cdk-overlay-container[_ngcontent-%COMP%]{position:fixed;z-index:1000}.cdk-overlay-container[_ngcontent-%COMP%]:empty{display:none}.cdk-global-overlay-wrapper[_ngcontent-%COMP%]{display:flex;position:absolute;z-index:1000}.cdk-overlay-pane[_ngcontent-%COMP%]{position:absolute;pointer-events:auto;box-sizing:border-box;z-index:1000;display:flex;max-width:100%;max-height:100%}.cdk-overlay-backdrop[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1000;pointer-events:auto;-webkit-tap-highlight-color:transparent;transition:opacity .4s cubic-bezier(.25,.8,.25,1);opacity:0}.cdk-overlay-backdrop.cdk-overlay-backdrop-showing[_ngcontent-%COMP%]{opacity:1}.cdk-high-contrast-active[_ngcontent-%COMP%]   .cdk-overlay-backdrop.cdk-overlay-backdrop-showing[_ngcontent-%COMP%]{opacity:.6}.cdk-overlay-dark-backdrop[_ngcontent-%COMP%]{background:rgba(0,0,0,.32)}.cdk-overlay-transparent-backdrop[_ngcontent-%COMP%]{transition:visibility 1ms linear,opacity 1ms linear;visibility:hidden;opacity:1}.cdk-overlay-transparent-backdrop.cdk-overlay-backdrop-showing[_ngcontent-%COMP%]{opacity:0;visibility:visible}.cdk-overlay-backdrop-noop-animation[_ngcontent-%COMP%]{transition:none}.cdk-overlay-connected-position-bounding-box[_ngcontent-%COMP%]{position:absolute;z-index:1000;display:flex;flex-direction:column;min-width:1px;min-height:1px}.cdk-global-scrollblock[_ngcontent-%COMP%]{position:fixed;width:100%;overflow-y:scroll}textarea.cdk-textarea-autosize[_ngcontent-%COMP%]{resize:none}textarea.cdk-textarea-autosize-measuring[_ngcontent-%COMP%]{padding:2px 0!important;box-sizing:content-box!important;height:auto!important;overflow:hidden!important}textarea.cdk-textarea-autosize-measuring-firefox[_ngcontent-%COMP%]{padding:2px 0!important;box-sizing:content-box!important;height:0!important}@keyframes _ngcontent-%COMP%_cdk-text-field-autofill-start{}@keyframes _ngcontent-%COMP%_cdk-text-field-autofill-end{}.cdk-text-field-autofill-monitored[_ngcontent-%COMP%]:-webkit-autofill{animation:_ngcontent-%COMP%_cdk-text-field-autofill-start 0s 1ms}.cdk-text-field-autofill-monitored[_ngcontent-%COMP%]:not(:-webkit-autofill){animation:_ngcontent-%COMP%_cdk-text-field-autofill-end 0s 1ms}.mat-focus-indicator[_ngcontent-%COMP%]{position:relative}.mat-focus-indicator[_ngcontent-%COMP%]:before{inset:0;position:absolute;box-sizing:border-box;pointer-events:none;display:var(--mat-focus-indicator-display, none);border:var(--mat-focus-indicator-border-width, 3px) var(--mat-focus-indicator-border-style, solid) var(--mat-focus-indicator-border-color, transparent);border-radius:var(--mat-focus-indicator-border-radius, 4px)}.mat-focus-indicator[_ngcontent-%COMP%]:focus:before{content:\\\"\\\"}.cdk-high-contrast-active[_ngcontent-%COMP%]{--mat-focus-indicator-display: block}.mat-mdc-focus-indicator[_ngcontent-%COMP%]{position:relative}.mat-mdc-focus-indicator[_ngcontent-%COMP%]:before{inset:0;position:absolute;box-sizing:border-box;pointer-events:none;display:var(--mat-mdc-focus-indicator-display, none);border:var(--mat-mdc-focus-indicator-border-width, 3px) var(--mat-mdc-focus-indicator-border-style, solid) var(--mat-mdc-focus-indicator-border-color, transparent);border-radius:var(--mat-mdc-focus-indicator-border-radius, 4px)}.mat-mdc-focus-indicator[_ngcontent-%COMP%]:focus:before{content:\\\"\\\"}.cdk-high-contrast-active[_ngcontent-%COMP%]{--mat-mdc-focus-indicator-display: block}[_nghost-%COMP%]     .mat-form-field-infix{padding:7px 0;margin:0;border-top:13px solid transparent}[_nghost-%COMP%]     .mat-form-field-suffix{transform:translateY(4px);margin-left:7px}mat-form-field[_ngcontent-%COMP%]{width:100%}.danger-zone-wrapper[_ngcontent-%COMP%]{margin-top:24px}.danger-zone-wrapper[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:5px 0;color:#f44336;font-weight:400}.danger-zone[_ngcontent-%COMP%]{list-style:none;border:1px solid #f44336;border-radius:3px;padding:15px;margin:10px 0}.danger-zone-cta-title[_ngcontent-%COMP%]{font-weight:500}.danger-zone-cta-content[_ngcontent-%COMP%]{display:flex;flex-direction:column}.danger-zone-cta-content[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{align-self:flex-end}.danger-zone-cta-content[_ngcontent-%COMP%]     .mat-form-field-infix{border-top:0}.danger-zone-cta-content[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{margin-bottom:1rem}\"]\n  });\n  return ProjectDialogComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}