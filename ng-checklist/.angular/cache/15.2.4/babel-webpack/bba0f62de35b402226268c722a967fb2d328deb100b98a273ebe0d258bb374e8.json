{"ast":null,"code":"import { FormControl } from '@angular/forms';\nimport * as fuzzysort from 'fuzzysort';\nimport { BehaviorSubject, combineLatest } from 'rxjs';\nimport { debounceTime, map, switchMap } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../search/search.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/material/autocomplete\";\nimport * as i5 from \"@angular/material/core\";\nimport * as i6 from \"@angular/forms\";\nfunction ChecklistSearchComponent_mat_option_3_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 7);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const result_r2 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(result_r2.document.category);\n  }\n}\nfunction ChecklistSearchComponent_mat_option_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 4);\n    i0.ɵɵtemplate(1, ChecklistSearchComponent_mat_option_3_span_1_Template, 2, 1, \"span\", 5);\n    i0.ɵɵelement(2, \"span\", 6);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const result_r2 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", result_r2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", result_r2.document.category);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"innerHTML\", result_r2.text, i0.ɵɵsanitizeHtml);\n  }\n}\nexport let ChecklistSearchComponent = /*#__PURE__*/(() => {\n  class ChecklistSearchComponent {\n    constructor(searchService, router) {\n      this.searchService = searchService;\n      this.router = router;\n      this.searchField = new FormControl();\n      this.focus$ = new BehaviorSubject('INIT');\n    }\n    ngOnInit() {\n      const search$ = this.searchField.valueChanges.pipe(debounceTime(150));\n      this.results$ = combineLatest(this.focus$, search$).pipe(map(([, term]) => term), switchMap(term => this.searchService.search(term)), map(results => results.map(this.mapToSearchResult)));\n    }\n    getOptionText(value) {\n      if (!value) {\n        return '';\n      }\n      return value.document.title;\n    }\n    optionSelected({\n      option\n    }) {\n      this.searchField.setValue('');\n      this.router.navigate([option.value.link]);\n    }\n    mapToSearchResult(result) {\n      return {\n        text: fuzzysort.highlight(result, '<b>', '</b>'),\n        document: result.obj.value,\n        link: result.obj.link\n      };\n    }\n  }\n  ChecklistSearchComponent.ɵfac = function ChecklistSearchComponent_Factory(t) {\n    return new (t || ChecklistSearchComponent)(i0.ɵɵdirectiveInject(i1.SearchService), i0.ɵɵdirectiveInject(i2.Router));\n  };\n  ChecklistSearchComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ChecklistSearchComponent,\n    selectors: [[\"ac-checklist-search\"]],\n    decls: 5,\n    vars: 6,\n    consts: [[\"placeholder\", \"Search\", \"spellcheck\", \"false\", 3, \"formControl\", \"matAutocomplete\", \"focus\"], [3, \"displayWith\", \"optionSelected\"], [\"auto\", \"matAutocomplete\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [3, \"value\"], [\"class\", \"result-type\", 4, \"ngIf\"], [1, \"text\", 3, \"innerHTML\"], [1, \"result-type\"]],\n    template: function ChecklistSearchComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"input\", 0);\n        i0.ɵɵlistener(\"focus\", function ChecklistSearchComponent_Template_input_focus_0_listener() {\n          return ctx.focus$.next(\"FOCUS\");\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(1, \"mat-autocomplete\", 1, 2);\n        i0.ɵɵlistener(\"optionSelected\", function ChecklistSearchComponent_Template_mat_autocomplete_optionSelected_1_listener($event) {\n          return ctx.optionSelected($event);\n        });\n        i0.ɵɵtemplate(3, ChecklistSearchComponent_mat_option_3_Template, 3, 3, \"mat-option\", 3);\n        i0.ɵɵpipe(4, \"async\");\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        const _r0 = i0.ɵɵreference(2);\n        i0.ɵɵproperty(\"formControl\", ctx.searchField)(\"matAutocomplete\", _r0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"displayWith\", ctx.getOptionText.bind(ctx));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(4, 4, ctx.results$));\n      }\n    },\n    dependencies: [i3.NgForOf, i3.NgIf, i4.MatAutocomplete, i5.MatOption, i4.MatAutocompleteTrigger, i6.DefaultValueAccessor, i6.NgControlStatus, i6.FormControlDirective, i3.AsyncPipe],\n    styles: [\".mat-ripple[_ngcontent-%COMP%]{overflow:hidden;position:relative}.mat-ripple[_ngcontent-%COMP%]:not(:empty){transform:translateZ(0)}.mat-ripple.mat-ripple-unbounded[_ngcontent-%COMP%]{overflow:visible}.mat-ripple-element[_ngcontent-%COMP%]{position:absolute;border-radius:50%;pointer-events:none;transition:opacity,transform 0ms cubic-bezier(0,0,.2,1);transform:scale3d(0,0,0)}.cdk-high-contrast-active[_ngcontent-%COMP%]   .mat-ripple-element[_ngcontent-%COMP%]{display:none}.cdk-visually-hidden[_ngcontent-%COMP%]{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap;outline:0;-webkit-appearance:none;-moz-appearance:none;left:0}[dir=rtl][_ngcontent-%COMP%]   .cdk-visually-hidden[_ngcontent-%COMP%]{left:auto;right:0}.cdk-overlay-container[_ngcontent-%COMP%], .cdk-global-overlay-wrapper[_ngcontent-%COMP%]{pointer-events:none;top:0;left:0;height:100%;width:100%}.cdk-overlay-container[_ngcontent-%COMP%]{position:fixed;z-index:1000}.cdk-overlay-container[_ngcontent-%COMP%]:empty{display:none}.cdk-global-overlay-wrapper[_ngcontent-%COMP%]{display:flex;position:absolute;z-index:1000}.cdk-overlay-pane[_ngcontent-%COMP%]{position:absolute;pointer-events:auto;box-sizing:border-box;z-index:1000;display:flex;max-width:100%;max-height:100%}.cdk-overlay-backdrop[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1000;pointer-events:auto;-webkit-tap-highlight-color:transparent;transition:opacity .4s cubic-bezier(.25,.8,.25,1);opacity:0}.cdk-overlay-backdrop.cdk-overlay-backdrop-showing[_ngcontent-%COMP%]{opacity:1}.cdk-high-contrast-active[_ngcontent-%COMP%]   .cdk-overlay-backdrop.cdk-overlay-backdrop-showing[_ngcontent-%COMP%]{opacity:.6}.cdk-overlay-dark-backdrop[_ngcontent-%COMP%]{background:rgba(0,0,0,.32)}.cdk-overlay-transparent-backdrop[_ngcontent-%COMP%]{transition:visibility 1ms linear,opacity 1ms linear;visibility:hidden;opacity:1}.cdk-overlay-transparent-backdrop.cdk-overlay-backdrop-showing[_ngcontent-%COMP%]{opacity:0;visibility:visible}.cdk-overlay-backdrop-noop-animation[_ngcontent-%COMP%]{transition:none}.cdk-overlay-connected-position-bounding-box[_ngcontent-%COMP%]{position:absolute;z-index:1000;display:flex;flex-direction:column;min-width:1px;min-height:1px}.cdk-global-scrollblock[_ngcontent-%COMP%]{position:fixed;width:100%;overflow-y:scroll}textarea.cdk-textarea-autosize[_ngcontent-%COMP%]{resize:none}textarea.cdk-textarea-autosize-measuring[_ngcontent-%COMP%]{padding:2px 0!important;box-sizing:content-box!important;height:auto!important;overflow:hidden!important}textarea.cdk-textarea-autosize-measuring-firefox[_ngcontent-%COMP%]{padding:2px 0!important;box-sizing:content-box!important;height:0!important}@keyframes _ngcontent-%COMP%_cdk-text-field-autofill-start{}@keyframes _ngcontent-%COMP%_cdk-text-field-autofill-end{}.cdk-text-field-autofill-monitored[_ngcontent-%COMP%]:-webkit-autofill{animation:_ngcontent-%COMP%_cdk-text-field-autofill-start 0s 1ms}.cdk-text-field-autofill-monitored[_ngcontent-%COMP%]:not(:-webkit-autofill){animation:_ngcontent-%COMP%_cdk-text-field-autofill-end 0s 1ms}.mat-focus-indicator[_ngcontent-%COMP%]{position:relative}.mat-focus-indicator[_ngcontent-%COMP%]:before{inset:0;position:absolute;box-sizing:border-box;pointer-events:none;display:var(--mat-focus-indicator-display, none);border:var(--mat-focus-indicator-border-width, 3px) var(--mat-focus-indicator-border-style, solid) var(--mat-focus-indicator-border-color, transparent);border-radius:var(--mat-focus-indicator-border-radius, 4px)}.mat-focus-indicator[_ngcontent-%COMP%]:focus:before{content:\\\"\\\"}.cdk-high-contrast-active[_ngcontent-%COMP%]{--mat-focus-indicator-display: block}.mat-mdc-focus-indicator[_ngcontent-%COMP%]{position:relative}.mat-mdc-focus-indicator[_ngcontent-%COMP%]:before{inset:0;position:absolute;box-sizing:border-box;pointer-events:none;display:var(--mat-mdc-focus-indicator-display, none);border:var(--mat-mdc-focus-indicator-border-width, 3px) var(--mat-mdc-focus-indicator-border-style, solid) var(--mat-mdc-focus-indicator-border-color, transparent);border-radius:var(--mat-mdc-focus-indicator-border-radius, 4px)}.mat-mdc-focus-indicator[_ngcontent-%COMP%]:focus:before{content:\\\"\\\"}.cdk-high-contrast-active[_ngcontent-%COMP%]{--mat-mdc-focus-indicator-display: block}[_nghost-%COMP%]{width:450px;display:flex}input[_ngcontent-%COMP%]{flex:1;outline:0;height:15px;border-radius:3px;border:1px solid gainsboro;font-size:1rem;line-height:1rem;padding:10px 8px;-webkit-appearance:none}.result-type[_ngcontent-%COMP%]{border-radius:2px;background:gainsboro;padding:2px 4px;font-size:11px;margin-right:6px;color:#737373;text-transform:uppercase}  .mat-autocomplete-panel{margin-top:5px;box-shadow:none!important;border:1px solid gainsboro}  .mat-autocomplete-panel b{color:#673ab7}\"]\n  });\n  return ChecklistSearchComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}